var _OA,_oaw,indexOf=[].indexOf;(_OA={gebi:function(t){return document.getElementById(t.replace("#",""))},gebc:function(t){return document.getElementsByClassName(t.replace(".",""))},gebn:function(t){var i;return null!=(i=document.getElementsByTagName(t.replace("<","").replace(">","")))?i:document.getElementsByName(t)}}).each=function(t,i,e){var a,o,s,n;if("string"==typeof t?t=t.startsWith("#")?[_OA.gebi(t)]:t.startsWith(".")?_OA.gebc(t):_OA.gebn(t):"object"==typeof t&&(Array.isArray(t)||(t=[t])),null!=t){for(n=[],o=0,s=t.length;o<s;o++)null!=(a=t[o])?"function"==typeof i?n.push(i(a)):n.push(_OA.set(a,i,e)):n.push(void 0);return n}},_OA.listen=function(t,i,e){return _OA.each(i,(function(i){var a;if("enter"===t?(t="keyup",a=function(t){if(13===t.keyCode)return e(t)}):a=e,!_OA.has(i,"listen_"+t))return _OA.class(i,"listen_"+t),i.addEventListener(t,(function(t){return a(t)}))}))},_OA.show=function(t,i,e){return _OA.each(t,(function(t){var a;return"string"==typeof i&&(t.innerHTML=(e?t.innerHTML:"")+i),"string"==typeof(a=_OA.get(t,"_l_display"))&&"none"!==a||(a="DIV"===t.tagName?"block":"inline"),t.style.display=a}))},_OA.hide=function(t){return _OA.each(t,(function(t){return"none"!==t.style.display&&_OA.set(t,"_l_display",t.style.display),t.style.display="none"}))},_OA.get=function(t,i){var e;return e=void 0,_OA.each(t,(function(t){if(null==i){try{e=t.value}catch(t){}"string"!=typeof e||e.length||(e=void 0)}try{return null!=e?e:e=t.getAttribute(i)}catch(t){}})),e},_OA.set=function(t,i,e){return _OA.each(t,(function(t){if(null==e||"value"===i||"val"===i)try{return t.value=null==e?i:e}catch(t){}else try{return t.setAttribute(i,e)}catch(t){}}))},_OA.checked=function(t){var i;return i=!0,_OA.each(t,(function(t){return i=t.checked})),i},_OA.html=function(t,i,e,a){var o=[];return _OA.each(t,(function(t){if("string"==typeof i&&(t.innerHTML=(e?t.innerHTML:"")+i),o.push(t.innerHTML),a)return _OA.show(t)})),1===o.length?o[0]:o.length?o:""},_OA.append=function(t,i){return _OA.html(t,i,!0)},_OA.remove=function(t){return _OA.each(t,(function(t){return t.parentNode.removeChild(t)}))},_OA.class=function(t,i){var e,a,o,s,n,r;for(r=[],null==(a=t.getAttribute("class"))&&(a=""),"string"==typeof i&&(a.includes(i)?a=a.replace(i,"").trim().replace(/  /g," "):(a.length&&(a+=" "),a+=i),t.setAttribute("class",a)),o=0,s=(n=a.split(" ")).length;o<s;o++)e=n[o],indexOf.call(r,e)<0&&r.push(e);return r},_OA.has=function(t,i){var e;return e=_OA.class(t),i.startsWith(".")&&(i=i.replace(".")),indexOf.call(e,i)>=0||!!t.getAttribute(i)},_OA.css=function(t,i,e){return _OA.each(t,(function(t){var a,o,s,n,r,l,h,d;for(d={},a=0,s=(r=("string"==typeof(l=_OA.get(t,"style"))?l:"").split(";")).length;a<s;a++)2===(n=r[a].split(":")).length&&(d[n[0].trim()]=n[1].trim());for(o in null!=e&&(d[i]=e),h="",d)""!==h&&(h+=";"),h+=o+":"+d[o];return _OA.set(t,"style",h)}))},_OA.jx=function(t,i,e,a){var o;return"object"==typeof i&&"function"!=typeof i.append&&(i=JSON.stringify(i)),(o=new XMLHttpRequest).open(null!=i?"POST":"GET",t),o.send(i),o.onload=function(){if(200!==o.status)try{a(o)}catch(t){}else try{e(JSON.parse(o.response),o)}catch(t){console.log(t);try{e(o)}catch(t){try{a(o)}catch(t){}}}if("function"==typeof _OA.loaded)return _OA.loaded(o)},o.onerror=function(t){try{return a(t)}catch(t){}}},(_oaw=function(t){var i,e,a,o,s,n,r,l,h,d,p;try{for(p in null==t&&(t={}),t)this[p]=t[p];if(this.api&&(this.api=this.api.replace("/service/oab",""),this.api=this.api.replace("dev.api.cottagelabs.com","beta.oa.works"),this.api=this.api.replace("api.cottagelabs.com","api.oa.works")),null==this.api&&(this.api=window.location.host.includes("dev.")?"https://beta.oa.works":"https://api.oa.works"),null==this.plugin&&(this.plugin="instantill"),null==this.element&&(this.element="#"+this.plugin),null==this.pushstate&&(this.pushstate=!0),null==this.uid&&(this.uid="anonymous"),null==this.config&&(this.config={}),null==this.local&&(this.local=!1),null==this.data&&(this.data={}),null==this.f&&(this.f={}),null==this.template&&(this.template=_oaw[this.plugin+"_template"]),null==this.css&&(this.css=_oaw.css),this._loading=!1,this.submit_after_metadata=!1,this.needmore=!1,this.file=!1,null==this.demo&&(this.demo=window.location.href.includes("/demo")&&(window.location.href.includes("oa.works")||window.location.href.includes("openaccessbutton.")||window.location.href.includes("shareyourpaper.")||window.location.href.includes("instantill."))),null!=this.loaded&&(_OA.loaded=this.loaded),window.location.search.includes("local=")&&(this.local=!!window.location.search.includes("local=true")),window.location.search.includes("clear=")||!1===this.local)try{localStorage.removeItem("_oaw_config_"+this.plugin)}catch(t){}if(window.location.search.includes("config="))try{this.config=JSON.parse(window.location.search.split("config=")[1].split("&")[0].split("#")[0])}catch(t){}if(window.location.search.includes("config."))for((e=window.location.search.split("config.")).shift(),r=0,h=e.length;r<h;r++)2===(a=e[r].split("=")).length&&(o=a[0].trim(),s=a[1].split("&")[0].split("#")[0].trim(),this.configure(o,s,!1));if(setTimeout((()=>this.configure()),1),!this.config.autorun_off){for("string"==typeof(i="string"==typeof this.config.autorunparams&&this.config.autorunparams.length?this.config.autorunparams.split(","):"object"==typeof this.config.autorunparams?this.config.autorunparams:["doi","title","url","atitle","rft_id","journal","issn","year","author"])&&(i=i.replace(/"/g,"").replace(/'/g,"").split(",")),l=0,d=i.length;l<d;l++)(p=(p=i[l]).split("=")[0].trim()).includes("=")&&(n=p.split("=")[1].trim()),window.location.search.replace("?","&").includes("&"+p+"=")&&(this.data[null!=n?n:p]=decodeURIComponent(window.location.search.replace("?","&").split("&"+p+"=")[1].split("&")[0].replace(/\+/g," ")));!this.data.doi&&window.location.href.split("?")[0].includes("/10.")&&window.location.href.split("?")[0].split("/10.")[1].indexOf("/")>1&&window.location.href.split("?")[0].split("/10.")[1].trim().split("/").length>1&&(this.data.doi="10."+window.location.href.split("?")[0].split("/10.")[1].replace(/\/$/,""))}return window.location.search.includes("email=")&&(this.data.email=window.location.search.split("email=")[1].split("&")[0].split("#")[0],_OA.remove("#_oaw_collect_email")),window.location.search.includes("confirmed=")&&(this.data.confirmed=window.location.search.split("confirmed=")[1].split("&")[0].split("#")[0]),window.location.search.includes("refresh=true")&&(this.data.refresh=!0),(this.data.doi||"instantill"===this.plugin&&(this.data.title||this.data.url))&&this.find(),window.addEventListener("popstate",(t=>this.state(t))),this}catch(t){return this.ping("instantill_or_shareyourpaper_try_initialise_catch")}}).prototype.cml=function(){return this.config.problem?this.config.problem:this.config.owner?this.config.owner:this.config.email?this.config.email:""},_oaw.prototype.contact=function(){return"Please try "+(this.cml()?'<a id="_oaw_contact_library" href="mailto:'+this.cml()+'">contacting us</a>':"contacting us")+" directly"},_oaw.prototype.loading=function(t){if(_OA.hide("#_oaw_error"),!0===t||!this._loading&&!1!==t)return _OA.html("._oaw_find","Searching ."),_OA.html("._oaw_submit","Submitting ."),_OA.html("._oaw_deposit","Depositing ."),_OA.html("._oaw_confirm","Depositing ."),this._loading=setInterval((function(){var t,i,e,a,o,s;for(s=[],e=0,a=(o=_OA.gebc("._oaw_loading")).length;e<a;e++)(i=(t=o[e]).innerHTML.split(".")).length>=4?s.push(t.innerHTML=i[0]):s.push(t.innerHTML=t.innerHTML+" .");return s}),700);try{clearInterval(this._loading)}catch(t){}return this._loading=!1,_OA.each("._oaw_loading",(t=>_OA.has(t,"_oaw_continue")?t.innerHTML="Continue":_OA.has(t,"_oaw_submit")?t.innerHTML="Complete request":_OA.has(t,"_oaw_deposit")?t.innerHTML="Deposit":_OA.has(t,"_oaw_find")?t.innerHTML="Next":_OA.has(t,"_oaw_confirm")?t.innerHTML="<b>My upload was an accepted manuscript</b>":t.innerHTML="Find "+(this.config.say_paper?"paper":"article")))},_oaw.prototype.state=function(t){var i,e,a,o,s;if(this.pushstate)try{if(s=window.location.pathname,null==t)if(window.location.href.includes("shareyourpaper.org"))if(window.location.href.includes("/10.")||window.location.href.replace(/\//g,"").endsWith(".org"))s=window.location.href.split("10.")[0]+(this.data.doi?this.data.doi:"")+window.location.search+window.location.hash;else{if(s+=window.location.search.split("?doi=")[0].split("&doi=")[0],s+=s.includes("?")?"&":"?",s+="doi="+this.data.doi,window.location.search.split("?doi=")[1].includes("&"))for((i=window.location.search.split("?doi=")[1].split("&")).shift(),e=0,o=i.length;e<o;e++)s+="&"+i[e];s+=window.location.hash}else window.location.href.includes("/setup")||window.location.href.includes("/demo")||null==this.data.doi&&null==this.data.title&&null==this.data.url||(a=this.data.doi?"doi":this.data.title?"title":"url",s+=window.location.search.split("?"+a+"=")[0].split("&"+a+"=")[0],s+=s.includes("?")?"&":"?",s+=a+"="+this.data[a]+window.location.hash);if(window.history.pushState("",null!=t?"search":"find",s),null!=t)return this.restart()}catch(t){}},_oaw.prototype.restart=function(t,i,e){var a;try{"_oaw_permissionemail"!==t.target.parentElement.id&&t.preventDefault()}catch(e){}return this.data={},this.f={},this.needmore=!1,this.loading(!1),this.file=!1,(a=_OA.gebi("_oaw_file"))&&(a.value=""),_OA.hide("._oaw_panel"),_OA.show("#_oaw_inputs"),this.configure(),this.state(),e&&_OA.show("#_oaw_error",e),i?(_OA.set("#_oaw_input",i),this.find()):_OA.set("#_oaw_input","")},_oaw.prototype.ping=function(t){var i;try{return t.includes(this.plugin)||(t.startsWith("_")||(t="_"+t),t=this.plugin+t),i=this.api+"/ping?action="+t+"&from="+this.uid+"&url="+encodeURIComponent(window.location.href),this.config.pilot&&(i+="&pilot="+this.config.pilot),this.config.live&&(i+="&live="+this.config.live),_OA.jx(i)}catch(t){}},_oaw.prototype.panel=function(t,i){var e;if((e=_OA.gebi("_oaw_"+(t.startsWith("_oaw_")?t.replace("_oaw_",""):t)))&&(_OA.hide("._oaw_panel"),_OA.show(e),i))return this.section(i)},_oaw.prototype.section=function(t){var i;if(null==(i=_OA.gebi("_oaw_"+(t.startsWith("_oaw_")?t.replace("_oaw_",""):t)))&&(i=_OA.gebc("_oaw_"+(t.startsWith("_oaw_")?t.replace("_oaw_",""):t))),i)return _OA.hide("._oaw_section"),_OA.show(i)},_oaw.prototype.validate=function(){var t;return this.config.terms&&!_OA.checked("#_oaw_read_terms")?_OA.show("#_oaw_error","<p>Please agree to the terms first.</p>"):("string"!=typeof(t=_OA.get("#_oaw_email"))&&(t=""),(t=t.trim()).length&&2===t.split("@").length?(this.data.email=t,"instantill"===this.plugin?this.submit():this.deposit()):(_OA.show("#_oaw_error","<p>Please provide your university email address.</p>"),_OA.css("#_oaw_email","border-color","#f04717"),_OA.gebi("#_oaw_email").focus()))},_oaw.prototype.submit=function(t){var i,e,a,o,s,n,r;try{try{t.preventDefault()}catch(t){}if(this.openurl()||this.data.email||!_OA.gebi("#_oaw_email")){if("{}"!==JSON.stringify(this.f)&&null!=this.f.metadata&&this.f.metadata.title&&this.f.metadata.journal&&this.f.metadata.year){for(this.loading(),(i={match:this.f.input,email:this.data.email,from:this.uid,plugin:this.plugin,embedded:window.location.href}).config=this.config,i.metadata=this.f.metadata?this.f.metadata:{},e=0,o=(r=["title","journal","year","doi"]).length;e<o;e++)a=r[e],!i.metadata[a]&&this.data[a]&&(i.metadata[a]=this.data[a]),i.metadata.doi&&i.metadata.doi.startsWith("http")&&(i.metadata.url=i.metadata.doi,delete i.metadata.doi);return s=this.config.notes?this.config.notes:"notes",this.data.usermetadata&&(i[s]="The user provided some metadata. "),this.config.pilot&&(i.pilot=this.config.pilot),this.config.live&&(i.live=this.config.live),(void 0!==this.f&&void 0!==this.f.ill&&void 0!==this.f.ill.subscription||void 0!==this.f&&this.f.url)&&("string"!=typeof i[s]?i[s]="":i[s]+=" ",void 0!==this.f.ill&&this.f.ill.subscription&&(i[s]+="Subscription check done, found "+(this.f.ill.subscription.url?this.f.ill.subscription.url:this.f.ill.subscription.journal?"journal":"nothing")+". "),null!=this.f.metadata&&(i[s]+="OA availability check done, found "+(this.f.url?this.f.url:"nothing")+". ")),(n=this.openurl())&&!i.email&&(i.forwarded=!0),!0===this.demo?(console.log("Not POSTing ILL and not forwarding to "+n+" for demo purposes"),console.log(i)):_OA.jx(this.api+"/ill",i,(t=>this.done(t)),(()=>this.done(!1)))}return this.submit_after_metadata?this.done(!1):(this.submit_after_metadata=!0,this.metadata())}return this.validate()}catch(t){return this.ping("instantill_try_submit_catch")}},_oaw.prototype.metadata=function(t){var i,e,a,o;for(i=0,e=(o=["title","year","journal","doi"]).length;i<e;i++)a=o[i],(void 0!==this.f&&void 0!==this.f.metadata&&void 0!==this.f.metadata[a]||void 0!==this.data[a])&&_OA.set("#_oaw_"+a,(this.f.metadata?this.f.metadata:this.data)[a]);return _OA.hide("._oaw_panel"),_OA.show("#_oaw_metadata")},_oaw.prototype.openurl=function(){var t,i,e,a,o,s,n,r,l,h;if(this.config.ill_form){for(e in i=JSON.parse(JSON.stringify(this.config)),a={sid:"sid",title:"atitle",doi:"rft_id",author:"aulast",journal:"title",page:"pages",published:"date",year:"rft.year"})i[e]||(i[e]=a[e]);for(s in l=i.ill_form,l+=l.includes("?")?"&":"?",i.ill_added_params&&(l+=i.ill_added_params.replace("?","")+"&"),l+=i.sid+"=InstantILL&",this.f.metadata?this.f.metadata:{}){if(h=!1,"author"===s){if("string"==typeof this.f.metadata.author)h=this.f.metadata.author;else if(Array.isArray(this.f.metadata.author))for(h="",o=0,n=this.f.metadata.author.length;o<n;o++){t=this.f.metadata.author[o];try{h.length&&(h+=", "),h+="string"==typeof t?t:"object"==typeof t&&t.family?t.family+(t.given?", "+t.given:""):JSON.stringify(t)}catch(t){}}}else"doi"!==s&&"pmid"!==s&&"pmc"!==s&&"pmcid"!==s&&"url"!==s&&"journal"!==s&&"title"!==s&&"year"!==s&&"issn"!==s&&"volume"!==s&&"issue"!==s&&"page"!==s&&"crossref_type"!==s&&"type"!==s&&"publisher"!==s&&"published"!==s&&"notes"!==s||(h=this.f.metadata[s]);h&&(l+=(i[s]?i[s]:s)+"="+encodeURIComponent(h)+"&")}return r=this.data.usermetadata?"The user provided some metadata. ":"",void 0!==this.f.ill&&void 0!==this.f.ill.subscription&&(r+="Subscription check done, found "+(this.f.ill.subscription.url?this.f.ill.subscription.url:this.f.ill.subscription.journal?"journal":"nothing")+". "),null!=this.f.metadata&&(r+="OA availability check done, found "+(this.f.url?this.f.url:"nothing")+". "),r&&(l+="&"+(this.config.notes?this.config.notes:"notes")+"="+r),l.replace("/&&/g","&")}return""},_oaw.prototype.done=function(t,i){var e;if(this.loading(!1),(e=this.openurl())?window.location=e:(_OA.hide("._oaw_panel"),_OA.hide("._oaw_done"),"string"==typeof t&&_OA.gebi("_oaw_"+t)?(_OA.show("#_oaw_"+t),"confirm"===t?_OA.hide("#_oaw_done_restart"):_OA.show("#_oaw_done_restart")):t?_OA.html("#_oaw_done_header","<h3>Thanks! Your request has been received</h3><p>Your confirmation code is: "+t+", this will not be emailed to you. The "+(this.config.say_paper?"paper":"article")+" will be sent to "+this.data.email+" as soon as possible.</p>"):(_OA.html("#_oaw_done_header","<h3>Sorry, we were not able to create an Interlibrary Loan request for you.</h3><p>"+this.contact()+"</p>"),_OA.html("#_oaw_done_restart","Try another"),this.ping(null!=i?i:"instantill_couldnt_submit_ill"),setTimeout((()=>this.restart()),6e3)),_OA.show("#_oaw_done")),"function"==typeof this.after)return this.after()},_oaw.prototype.deposit=function(t){var i,e,a,o,s;try{try{t.preventDefault()}catch(t){}if(!this.data.email&&_OA.gebi("#_oaw_email"))return this.validate();if(!0!==this.demo||null==this.data.doi||!this.data.doi.startsWith("10.1234/oab-syp-")){if(null!=(a=_OA.gebi("#_oaw_file"))&&null!=a.files&&a.files.length)this.file=new FormData,this.file.append("file",a.files[0]);else if(!0!==this.file)return _OA.show("#_oaw_error","<p>Whoops, you need to give us a file! Check it's uploaded.</p>"),void _OA.css("#_oaw_file","border-color","#f04717");if(this.loading(),e={from:this.uid,plugin:this.plugin,embedded:window.location.href,metadata:void 0!==this.f?this.f.metadata:void 0},!0===this.demo&&(e.demo=!0),e.config=this.config,this.data.email&&(e.email=this.data.email),this.data.confirmed&&(e.confirmed=this.data.confirmed),void 0!==this.f&&"string"==typeof this.f.url&&(e.redeposit=this.f.url),this.config.pilot&&(e.pilot=this.config.pilot),this.config.live&&(e.live=this.config.live),"boolean"!=typeof this.file){for(i in e)if("metadata"===i)for(s in e[i])"string"!=typeof e[i][s]&&"number"!=typeof e[i][s]||this.file.append(s,e[i][s]);else"object"==typeof e[i]?this.file.append(i,JSON.stringify(e[i])):this.file.append(i,e[i]);e=this.file}return _OA.jx(this.api.replace("://","://bg.")+"/deposit",e,(t=>(this.loading(!1),"boolean"!=typeof this.file?void 0!==t.zenodo&&t.zenodo.already||this.data.confirmed&&(void 0===t.zenodo||!t.zenodo.url)?this.done("check"):t.error?this.done("partial"):void 0!==t.zenodo&&t.zenodo.url?(_OA.set("#_oaw_zenodo_url",t.zenodo.url),t.embargo?(o="<p>You've done your part for now. Unfortunately, "+(void 0!==this.f&&void 0!==this.f.metadata&&this.f.metadata.shortname?this.f.metadata.shortname:void 0!==this.f&&void 0!==this.f.metadata&&this.f.metadata.journal?this.f.metadata.journal:"the journal")+" won't let us make it public until ",o+=new Date(t.embargo).toLocaleString("en-GB",{year:"numeric",month:"long",day:"numeric"}).replace(/(11|12|13) /,"$1th ").replace("1 ","1st ").replace("2 ","2nd ").replace("3 ","3rd ").replace(/([0-9]) /,"$1th "),o+=". After release, you'll find your paper on "+(this.config.repo_name?this.config.repo_name:"ScholarWorks")+", Google Scholar, Web of Science.</p>",o+="<h3>Your paper will be freely available at this link:</h3>"):(o="<p>You'll soon find your paper freely available in "+(this.config.repo_name?this.config.repo_name:"ScholarWorks")+", Google Scholar, Web of Science, and other popular tools.",o+="<h3>Your paper is now freely available at this link:</h3>"),_OA.html("#_oaw_zenodo_embargo",o),this.done("zenodo")):this.done("confirm"):"redeposit"===t.type?this.done("redeposit"):this.done("success"))),(()=>(this.loading(!1),_OA.show("#_oaw_error","<p>Sorry, we were not able to deposit this paper for you. "+this.contact()+'</p><p><a href="#" class="_oaw_restart" id="_oaw_sorry_try_again"><b>Try again</b></a></p>'),this.ping("shareyourpaper_couldnt_submit_deposit"))))}if("10.1234/oab-syp-confirm"!==this.data.doi?(o="<p>You'll soon find your paper freely available in "+(this.config.repo_name?this.config.repo_name:"ScholarWorks")+", Google Scholar, Web of Science, and other popular tools.",o+="<h3>Your paper is now freely available at this link:</h3>",_OA.html("#_oaw_zenodo_embargo",o),_OA.set("#_oaw_zenodo_url","https://zenodo.org/record/3703317"),this.done("zenodo")):this.done("confirm"),"function"==typeof this.loaded)return this.loaded()}catch(t){return this.ping("shareyourpaper_try_deposit_catch")}},_oaw.prototype.permissions=function(t){var i,e,a,o,s,n,r,l;try{if(null!=t&&(this.f=t),_OA.gebi(this.element)){if(this.loading(!1),void 0===this.f&&(this.f={}),void 0===this.f.metadata&&(this.f.metadata={}),void 0===this.f.permissions&&(this.f.permissions={}),void 0===this.f.permissions.best_permission&&(this.f.permissions.best_permission={}),this.f.doi_not_in_crossref||this.f.doi_not_in_oadoi)return this.f={},_OA.show("#_oaw_error","<p>Double check your DOI, that doesn't look right to us.</p>"),_OA.gebi("_oaw_input").focus();if(void 0!==this.f.metadata.crossref_type&&"journal-article"!==this.f.metadata.crossref_type&&"proceedings-article"!==this.f.metadata.crossref_type||void 0!==this.f.metadata.type&&"journal-article"!==this.f.metadata.type&&"proceedings-article"!==this.f.metadata.type)return _OA.gebi("_oaw_input").focus(),i="<p>Sorry, right now this only works with academic journal articles.",(this.cml()||this.config.old_way&&this.config.old_way.includes("@"))&&(i+=' To get help with depositing, <a href="',i+=this.config.old_way?(this.config.old_way.includes("@")?"mailto:":"")+this.config.old_way:"mailto:"+this.cml(),i+="?subject=Help%20depositing%20&body=Hi%2C%0D%0A%0D%0AI'd%20like%20to%20deposit%3A%0D%0A%0D%0A%3C%3CPlease%20insert%20a%20full%20citation%3E%3E%0D%0A%0D%0ACan%20you%20please%20assist%20me%3F%0D%0A%0D%0AYours%20sincerely%2C\">click here</a>"),this.restart(void 0,void 0,i+".</p>");if(this.f.metadata.title){_OA.hide("._oaw_panel"),_OA.hide("._oaw_section"),_OA.show("#_oaw_permissions"),this.loading(!1),l='terms <a id="_oaw_terms" href="https://openaccessbutton.org/terms" target="_blank">[1]</a>',this.config.terms&&(l+=' <a id="_oaw_config_terms" href="'+this.config.terms+'" target="_blank">[2]</a>'),o="your.name@institution.edu",null!=this.config.email_domains&&this.config.email_domains.length&&("string"==typeof this.config.email_domains&&(this.config.email_domains=this.config.email_domains.split(",")),(o=this.config.email_domains[0]).includes("@")&&(o=o.split("@")[1]),o.includes("//")&&(o=o.split("//")[1]),o=o.toLowerCase().replace("www.","")),(null==o||o.length<3)&&(o="your.name@institution.edu"),o.includes("@")||(o="your.name@"+o),this.data.email?_OA.hide("._oaw_get_email"):(_OA.show("._oaw_get_email"),_OA.set("#_oaw_email","placeholder",o),_OA.html("._oaw_terms",l)),n="";try{for(e in this.f.permissions.best_permission.provenance.archiving_policy)n+=' <a id="_oaw_policy_text" target="_blank" href="'+this.f.permissions.best_permission.provenance.archiving_policy[e]+'">['+(parseInt(e)+1)+"]</a>"}catch(t){}return _OA.html("._oaw_refs",n),a=this.f.metadata.doi?'<a id="_oaw_your_paper" target="_blank" href="https://doi.org/'+this.f.metadata.doi+'"><u>your paper</u></a>':"your paper",_OA.html("._oaw_your_paper",("publishedVersion"===this.f.permissions.best_permission.version?"the publisher pdf of ":"")+a),_OA.html("._oaw_journal",this.f.metadata.shortname?this.f.metadata.shortname:"the journal"),this.f.url?(_OA.set("._oaw_oa_url","href",this.f.url),this.config.oa_deposit_off?(_OA.hide("._oaw_get_email"),_OA.show("._oaw_oa")):(this.file=!0,_OA.show("._oaw_oa_deposit"))):this.f.permissions.best_permission.can_archive?("publishedVersion"===this.f.permissions.best_permission.version&&_OA.hide("#_oaw_not_pdf"),"string"==typeof this.f.permissions.best_permission.licence&&this.f.permissions.best_permission.licence.startsWith("other-")?_OA.html("._oaw_licence","under the publisher's terms"+n):_OA.html("._oaw_licence",this.f.permissions.best_permission.licence?this.f.permissions.best_permission.licence:"CC-BY"),_OA.show("._oaw_archivable")):this.config.dark_deposit_off?(r="mailto:"+(this.f.permissions.best_permission.permissions_contact?this.f.permissions.best_permission.permissions_contact:this.config.deposit_help?this.config.deposit_help:this.cml())+"?",this.f.permissions.best_permission.permissions_contact&&(r+="cc="+(this.config.deposit_help?this.config.deposit_help:this.cml())+"&"),r+="subject=Request%20to%20self%20archive%20"+(this.f.metadata.doi?this.f.metadata.doi:"")+"&body=",r+=encodeURIComponent("To whom it may concern,\n\n"),r+=encodeURIComponent('I am writing to request permission to deposit the full text of my paper "'+(this.f.metadata.title?this.f.metadata.title:this.f.metadata.doi?this.f.metadata.doi:"Untitled paper")+'" '),this.f.metadata.journal&&(r+=encodeURIComponent('published in "'+this.f.metadata.journal+'"')),r+=encodeURIComponent("\n\nI would like to archive the final pdf. If that is not possible, I would like to archive the accepted manuscript. Ideally, I would like to do so immediately but will respect a reasonable embargo if requested.\n\n"),this.config.repo_name&&(r+=encodeURIComponent('I plan to deposit it into "'+this.config.repo_name+'", a not-for-profit, digital, publicly accessible repository for scholarly work created for researchers '+(this.config.institution_name?"at "+this.config.institution_name:"")+". It helps make research available to a wider audience, get citations for the original article, and assure its long-term preservation. The deposit will include a complete citation of the published version, and a link to it.\n\n")),r+=encodeURIComponent("Thank you for your attention and I look forward to hearing from you."),_OA.set("#_oaw_reviewemail","href",r),s="mailto:"+(this.config.deposit_help?this.config.deposit_help:this.cml())+"?subject=Permission%20Given%20to%20Deposit%20"+(this.f.metadata.doi?this.f.metadata.doi:"")+"&body=",s+=encodeURIComponent("To whom it may concern,\n\nAttached is written confirmation of permission I've been given to deposit, and the permitted version of my paper: "),s+=encodeURIComponent('"'+(this.f.metadata.title?this.f.metadata.title:this.f.metadata.doi?this.f.metadata.doi:"Untitled paper")+'" \n\nCan you please deposit it into the repository on my behalf? \n\nSincerely, '),_OA.set("#_oaw_permissionemail","href",s),_OA.hide("._oaw_get_email"),_OA.show("._oaw_permission_required")):(this.file=!0,_OA.hide("#_oaw_file"),_OA.show("._oaw_dark_deposit"))}return _OA.show("#_oaw_error","<h3>Unknown paper</h3><p>Sorry, we cannot find this paper or sufficient metadata. "+this.contact()+"</p>"),this.ping("shareyourpaper_unknown_article")}return setTimeout((()=>this.permissions()),100)}catch(t){return this.ping("shareyourpaper_try_permissions_catch")}},_oaw.prototype.findings=function(t){var i,e,a,o,s,n;try{if(null!=t&&(this.f=t),void 0===this.f.metadata&&(this.f.metadata={}),!_OA.gebi(this.element))return setTimeout((()=>this.findings()),100);if(this.loading(!1),(e=this.f.metadata.crossref_type?this.f.metadata.crossref_type:this.f.metadata.type?this.f.metadata.type:void 0)&&"journal-article"!==e&&"proceedings-article"!==e&&"posted-content"!==e)return a="book-section"===e||"book-part"===e||"book-chapter"===e?"<p>Please make your request through our "+(this.config.book?'<a id="_oaw_book_form" href="'+this.config.book+'">book form</a>':"book form"):"<p>We can only process academic journal articles, please use another form.",void this.restart(void 0,void 0,a+"</p>");if(_OA.hide("._oaw_panel"),_OA.hide("._oaw_section"),this.config.resolver&&((t={match:this.f.input,from:this.uid,plugin:this.plugin,embedded:window.location.href}).config=this.config,t.metadata=this.f.metadata,this.config.pilot&&(t.pilot=this.config.pilot),this.config.live&&(t.live=this.config.live),void 0===this.f.ill&&(this.f.ill={}),void 0===this.f.ill.subscription&&(this.f.ill.subscription={}),this.f.ill.subscription.url?t.resolved="subscription":this.f.url?t.resolved="open":(n=this.openurl())&&(t.resolved="library"),null!=t.resolved&&(t.url=this.f.ill.subscription.url?this.f.ill.subscription.url:this.f.url?this.f.url:n,_OA.jx(this.api+"/ill",t,(()=>window.location=this.f.ill.subscription.url?this.f.ill.subscription.url:this.f.url?this.f.url:n),(()=>window.location=this.f.ill.subscription.url?this.f.ill.subscription.url:this.f.url?this.f.url:n)))),_OA.show("#_oaw_findings"),void 0!==this.f.ill.error&&_OA.show("#_oaw_error","<p>Please note, we encountered errors querying the following subscription services: "+this.f.ill.error.join(", ")+"</p>"),!this.f.metadata.title||!this.f.metadata.journal&&!this.data.usermetadata)return this.data.usermetadata?(_OA.html("#_oaw_citation","<h3>Unknown "+(this.config.say_paper?"paper":"article")+"</h3><p>Sorry, we can't find this "+(this.config.say_paper?"paper":"article")+" or sufficient metadata. "+this.contact()+"</p>"),this.ping("shareyourpaper_unknown_article"),setTimeout((()=>this.restart()),6e3)):this.metadata();if(i="<h2>"+this.f.metadata.title+"</h2>",(this.f.metadata.year||this.f.metadata.journal||this.f.metadata.volume||this.f.metadata.issue)&&(i+="<p><i>",this.f.metadata.year&&(i+=this.f.metadata.year+(this.f.metadata.journal||this.f.metadata.volume||this.f.metadata.issue?", ":"")),this.f.metadata.journal?i+=this.f.metadata.journal:(this.f.metadata.volume&&(i+="vol. "+this.f.metadata.volume),this.f.metadata.issue&&(i+=(this.f.metadata.volume?", ":"")+"issue "+this.f.metadata.issue)),i+="</i></p>"),_OA.html("#_oaw_citation",i),s=!1,o=!1,this.f.ill.subscription.journal||this.f.ill.subscription.url?(s=!0,null!=this.f.ill.subscription.url&&_OA.set("#_oaw_sub_url","href",this.f.ill.subscription.url),_OA.show("#_oaw_sub_available")):this.f.url&&(o=!0,_OA.set("#_oaw_url","href",this.f.url),_OA.show("#_oaw_oa_available")),null!=this.f.ill&&!(this.config.ill_if_sub_off&&s||this.config.ill_if_oa_off&&o))return _OA.html("#_oaw_cost_time","<p>It "+(this.config.cost?"costs "+this.config.cost:"is free to you,")+" and we'll usually email the link within "+(this.config.time?this.config.time:"24 hours")+".<br></p>"),this.data.email||(this.openurl()?_OA.hide("#_oaw_collect_email"):this.config.terms?(_OA.show("#_oaw_terms_note"),_OA.set("#_oaw_terms_link","href",this.config.terms)):_OA.hide("#_oaw_terms_note")),_OA.show("#_oaw_ask_library")}catch(a){return this.ping("instantill_try_findings_catch")}},_oaw.prototype.find=function(t){var i,e,a,o,s,n,r;try{try{t.preventDefault()}catch(t){}if("{}"!==JSON.stringify(this.f)||this.needmore){for(a=0,s=(e=["title","journal","year","doi"]).length;a<s;a++)o=e[a],(n=_OA.get("#_oaw_"+o))&&this.data[o]!==n&&(this.data[o]=n,this.data.usermetadata=!0);if(this.data.year&&4!==this.data.year.length)return delete this.data.year,void _OA.show("#_oaw_error","<p>Please provide the full year e.g 2019</p>");if(!this.data.title||!this.data.journal||!this.data.year)return void _OA.show("#_oaw_error","<p>Please complete all required fields</p>");if(this.submit_after_metadata)return void this.submit()}return this.data.atitle&&!this.data.title&&(this.data.title=this.data.atitle),this.data.rft_id&&!this.data.doi&&(this.data.doi=this.data.rft_id),this.data.doi&&this.data.doi.includes("10.")&&this.data.doi.startsWith("http")&&(this.data.url=this.data.doi,delete this.data.doi),(r=_OA.get("#_oaw_input"))?(r=r.trim().replace(/\.$/,"")).length&&(r.includes(" ")?this.data.title=r:r.includes("doi.org/")?(this.data.url=r,this.data.doi="10."+r.split("/10.")[1].split(" ")[0]):r.includes("10.")?this.data.doi=r:r.startsWith("http")||r.includes("www.")?this.data.url=r:0===r.toLowerCase().replace("pmc","").replace("pmid","").replace(":","").replace(/[0-9]/g,"").length?this.data.id=r:this.data.title=r):(this.data.doi||this.data.title||this.data.url||this.data.id)&&_OA.set("#_oaw_input",this.data.doi?this.data.doi:this.data.title?this.data.title:this.data.url?this.data.url:this.data.id),"instantill"!==this.plugin||this.data.doi||this.needmore||void 0!==this.f&&void 0!==this.f.metadata&&this.f.metadata.journal||this.data.title&&!(this.data.title.length<30&&this.data.title.split(" ").length<3)?this.data.doi||"shareyourpaper"!==this.plugin&&(this.data.url||this.data.pmid||this.data.pmcid||this.data.title||this.data.id)?!this.data.doi||"shareyourpaper"!==this.plugin||this.data.doi.startsWith("10")&&this.data.doi.includes("/")&&this.data.doi.includes(".")&&!(this.data.doi.length<8)?(this.state(),this.loading(),this.data.config=this.config,this.data.from||(this.data.from=this.uid),this.data.plugin||(this.data.plugin=this.plugin),this.data.embedded||(this.data.embedded=window.location.href),this.config.pilot&&void 0===this.data.pilot&&(this.data.pilot=this.config.pilot),this.config.live&&void 0===this.data.live&&(this.data.live=this.config.live),!0===this.demo&&("Engineering a Powerfully Simple Interlibrary Loan Experience with InstantILL"===this.data.title||"10.1234/567890"===this.data.doi||null!=this.data.doi&&this.data.doi.startsWith("10.1234/oab-syp"))?((i={metadata:{title:"Engineering a Powerfully Simple Interlibrary Loan Experience with InstantILL",year:"2019",crossref_type:"journal-article",doi:this.data.doi?this.data.doi:"10.1234/oab-syp-aam"}}).metadata.journal="Proceedings of the 16th IFLA ILDS conference: Beyond the paywall - Resource sharing in a disruptive ecosystem",i.metadata.author=[{given:"Mike",family:"Paxton"},{given:"Gary",family:"Maixner III"},{given:"Joseph",family:"McArthur"},{given:"Tina",family:"Baich"}],i.ill={subscription:{findings:{},uid:this.uid,lookups:[],error:[],url:"https://scholarworks.iupui.edu/bitstream/handle/1805/20422/07-PAXTON.pdf?sequence=1&isAllowed=y"}},i.permissions={best_permission:{can_archive:"10.1234/oab-syp-aam"===this.data.doi,version:"10.1234/oab-syp-aam"===this.data.doi?"postprint":void 0},file:{archivable:!0,archivable_reason:"Demo acceptance",version:"postprint",licence:"cc-by",same_paper:!0,name:"example.pdf",format:"pdf",checksum:"example-checksum"}},"instantill"===this.plugin?this.findings(i):this.permissions(i)):_OA.jx(this.api+"/find",this.data,(t=>"instantill"===this.plugin?this.findings(t):this.permissions(t)),(()=>_OA.show("#_oaw_error","<p>Oh dear, the service is down! We're aware, and working to fix the problem. "+this.contact()+"</p>")))):(delete this.data.doi,_OA.set("#_oaw_input",""),_OA.gebi("_oaw_input").focus(),_OA.show("#_oaw_error",'<p>Please provide a DOI. If you\'re not sure what a DOI is, go <a id="_oaw_doi_howto" href="https://library.uic.edu/help/article/1966/what-is-a-doi-and-how-do-i-use-them-in-citations" target="_blank">here</a>.</p>')):"shareyourpaper"===this.plugin?(delete this.data.title,delete this.data.url,delete this.data.id,_OA.show("#_oaw_error",'<p>Please provide a DOI. If you\'re not sure what a DOI is, go <a id="_oaw_doi_howto" href="https://library.uic.edu/help/article/1966/what-is-a-doi-and-how-do-i-use-them-in-citations" target="_blank">here</a>.</p>')):_OA.show("#_oaw_error","<p><span>&#10060;</span> Sorry please provide the full DOI, title, citation, PMID or PMC ID.</p>"):(this.needmore=!0,this.metadata())}catch(t){return this.ping(this.plugin+"_try_find_catch")}},_oaw.css="<style>._oaw_form { display: inline-block; width: 100%; height: 34px; padding: 6px 12px; font-size: 1em; line-height: 1.428571429; color: #555555; vertical-align: middle; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; border-radius: 4px; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; } ._oaw_button { display: table-cell; height:34px; padding: 6px 3px; margin-bottom: 0; font-size: 1em; font-weight: normal; line-height: 1.428571429; text-decoration: none; text-align: center; white-space: nowrap; vertical-align: middle; cursor: pointer; background-image: none; border: 1px solid transparent; border-radius: 4px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; color: #ffffff; background-color: #428bca; border-color: #357ebd; } </style>",_oaw.instantill_template='<div class="_oaw_panel" id="_oaw_inputs">   <p id="_oaw_intro"> If you need <span class="_oaw_paper">an article</span> you can request it from any library in the world through Interlibrary loan.   <br>Start by entering a full <span class="_oaw_paper">article</span> title, citation, or DOI:<br></p>   <p><input class="_oaw_form" type="text" id="_oaw_input" placeholder="e.g. World Scientists Warning of a Climate Emergency" aria-label="Enter a search term" style="box-shadow:none;"></input></p>   <p><a class="_oaw_find btn-iu _oaw_button _oaw_loading" id="_oaw_find" href="#" aria-label="Search" style="min-width:140px;">Find <span class="_oaw_paper">article</span></a></p>   <div id="_oaw_book_or_other"></div>   <div id="_oaw_advanced_account_info"></div> </div> <div class="_oaw_panel" id="_oaw_findings" style="display:none;">   <div id="_oaw_citation">     <h2>A title</h2>     <p><b>And citation string, OR demo title OR Unknown <span class="_oaw_paper">article</span> and refer to library</b></p>   </div>   <p id="_oaw_wrong_paper"><a class="_oaw_wrong" href="#"><b>This is not the <span class="_oaw_paper">article</span> I searched</b></a></p>   <div class="_oaw_section" id="_oaw_sub_available">     <h3>We have an online copy instantly available</h3>     <p>You should be able to access it on the publisher\'s website.</p> <p><a target="_blank" id="_oaw_sub_url" href="#"><b>Open <span class="_oaw_paper">article</span> in a new tab</b></a></p>   </div>   <div class="_oaw_section" id="_oaw_oa_available">     <h3><br>There is a free, instantly accessible copy online</h3>     <p>It may not be the final published version and may lack graphs or figures making it unsuitable for citations.</p>     <p><a id="_oaw_url" target="_blank" href="#"><b>Open <span class="_oaw_paper">article</span> in a new tab</b></a></p>   </div>   <div class="_oaw_section" id="_oaw_ask_library">     <h3><br>Ask the library to send you a digital copy via Interlibrary Loan</h3>     <div id="_oaw_cost_time"><p>It is free to you, and we\'ll usually email the link within 24 hours.<br></p></div>     <div id="_oaw_collect_email">       <p id="_oaw_terms_note"><input type="checkbox" id="_oaw_read_terms"> I have read the <a id="_oaw_terms_link" target="_blank" href="#">terms and conditions</a></p>       <p><input placeholder="Your university email address" id="_oaw_email" type="text" class="_oaw_form"></p>     </div>     <p><a class="_oaw_submit btn-iu _oaw_button _oaw_loading" href="#" id="_oaw_submit" style="min-width:140px;">Complete request</a></p>     <p><a href="#" class="_oaw_restart" id="_oaw_try_another"><b>Try another</b></a></p>   </div> </div> <div class="_oaw_panel" id="_oaw_metadata" style="display:none;">   <h2>Sorry we didn\'t find that!</h2>   <p id="_oaw_doi_not_in_crossref" style="display:none;">The DOI <span id="_oaw_bad_doi">you entered</span> does not appear in Crossref</p>   <p>Please provide or amend the <span class="_oaw_paper">article</span> details.</p>   <p><span class="_oaw_paper">Article</span> title (required)<br><input class="_oaw_form" id="_oaw_title" type="text" placeholder="e.g The State of OA: A large-scale analysis of Open Access"></p>   <p>Journal title (required)<br><input class="_oaw_form" id="_oaw_journal" type="text" placeholder="e.g. Nature"></p>   <p>Year of publication (required)<br><input class="_oaw_form" id="_oaw_year" type="text" placeholder="e.g 1992"></p>   <p><span class="_oaw_paper">Article</span> DOI or URL<br><input class="_oaw_form" id="_oaw_doi" type="text" placeholder="e.g 10.1126/scitranslmed.3008973"></p>   <p><a href="#" class="_oaw_find btn-iu _oaw_button _oaw_loading _oaw_continue" id="_oaw_continue" style="min-width:140px;">Continue</a></p>   <p> <a href="#" class="_oaw_restart" id="_oaw_try_again"><b>Try another</b></a> <span id="_oaw_advanced_ill_form" style="display:none;"></span> </p> </div> <div class="_oaw_panel" id="_oaw_done" style="display:none;">   <div id="_oaw_done_header">     <h2>Thanks! Your request has been received.</h2>     <p>And confirmation code and tell we will email soon - OR sorry we could not create an ILL, and refer back to library if possible.</p>   </div>   <p><a href="#" class="_oaw_restart btn-iu _oaw_button" id="_oaw_done_restart" id="_oaw_restart" style="min-width:140px;">Do another</a></p> </div> <div id="_oaw_error"></div> <div id="_oaw_pilot"></div>',_oaw.shareyourpaper_template='<div class="_oaw_panel" id="_oaw_inputs">   <h2>Make your research visible and see 30% more citations</h2>   <p><span id="_oaw_lib_info">We can help you make your paper Open Access, for free, wherever you publish.   It\'s legal and takes just minutes.</span> Join millions of researchers sharing their papers freely with   colleagues and the public.</p> <h3>Start by entering the DOI of your paper</h3> <p>We\'ll gather information   about your paper and find the easiest way to share it.</p>   <p><input class="_oaw_form" type="text" id="_oaw_input" placeholder="e.g. 10.1126/scitranslmed.abc2344" aria-label="Enter a search term" style="box-shadow:none;"></input></p>   <p><a class="_oaw_find btn-iu _oaw_button _oaw_loading" href="#" id="_oaw_find" aria-label="Search" style="min-width:140px;">Next</a></p>   <p><a id="_oaw_nodoi" href="mailto:help@openaccessbutton.org?subject=Help%20depositing%20my%20paper&body=Hi%2C%0D%0A%0D%0AI\'d%20like%20to%20deposit%3A%0D%0A%0D%0A%3C%3CPlease%20insert%20a%20full%20citation%3E%3E%0D%0A%0D%0ACan%20you%20please%20assist%20me%3F%0D%0A%0D%0AYours%20sincerely%2C"><b>My paper doesn\'t have a DOI</b></a></p> </div> <div class="_oaw_panel" id="_oaw_permissions" style="display:none;">   <div class="_oaw_section _oaw_oa" id="_oaw_oa">     <h2>Your paper is already freely available!</h2>     <p>Great news, you\'re already getting the benefits of sharing your work! Your publisher or co-author have already shared it.</p>     <p><a target="_blank" href="#" class="_oaw_oa_url btn-iu _oaw_button" style="min-width:140px;">See free version</a></p>     <p><a href="#" class="_oaw_restart" id="_oaw_restart"><b>Do another</b></a></p>   </div>   <div class="_oaw_section _oaw_permission_required" id="_oaw_permission_required">     <h2>You may share your paper if you ask the journal</h2>     <p>Unlike most, <span class="_oaw_journal">the journal</span> requires that you ask them before you share your paper freely. Asking only takes a moment as we find out who to contact and have drafted an email for you.</p>     <p><a target="_blank" id="_oaw_reviewemail" href="#" class="btn-iu _oaw_button" style="min-width:140px;">Review Email</a></p> <p><a target="_blank" id="_oaw_permissionemail" class="_oaw_restart" href="#"><b>I\'ve got permission now!</b></a></p>   </div>   <div class="_oaw_section _oaw_oa_deposit" id="_oaw_oa_deposit">     <h2>Your paper is already freely available!</h2>     <p>Great news, you\'re already getting the benefits of sharing your work! Your publisher or co-author have already shared a <a class="_oaw_oa_url" id="_oaw_goto_oa_url" target="_blank" href="#">freely available copy</a>.</p>     <h3 class="_oaw_section _oaw_get_email">Please enter your email to confirm deposit</h3>   </div>   <div class="_oaw_section _oaw_archivable" id="_oaw_archivable">     <h2>You can freely share your paper!</h2>     <p><span class="_oaw_library">The library has</span> checked and <span class="_oaw_journal">the journal</span> encourages you to freely share <span class="_oaw_your_paper">your paper</span> so colleagues and the public can freely read and cite it. <span class="_oaw_refs"></span></p>     <div id="_oaw_not_pdf">       <h3><span>&#10003;</span> Find the manuscript the journal accepted. It\'s not a PDF from the journal site</h3>       <p>This is the only version you\'re able to share under copyright. The accepted manuscript is the word file or Latex export you sent the publisher after peer-review and before formatting (publisher proofs).</p>       <h3><span>&#10003;</span> Check there aren\'t publisher logos or formatting</h3>       <p>It\'s normal to share accepted manuscripts as the research is the same. It\'s fine to save your file as a pdf, make small edits to formatting, fix typos, remove comments, and arrange figures.</p>     </div>     <h3 class="_oaw_section _oaw_get_email"><span>&#10003;</span> Tell us your email</h3>   </div>   \x3c!-- <div class="_oaw_section _oaw_bronze_archivable" id="_oaw_bronze_archivable">     <h2>Keep your paper freely available!</h2>     <p>For now, <span class="_oaw_journal">the journal</span> is sharing <span class="_oaw_your_paper">your paper</span> for free, but that might change. You can do the following to ensure colleagues and the public can always freely read and cite it <span class="_oaw_refs"></span>.</p>     <div id="_oaw_not_pdf">       <h3><span>&#10003;</span> Find the manuscript the journal accepted. It\'s not a PDF from the journal site</h3>       <p>This is the only version you\'re able to share under copyright. The accepted manuscript is the word file or Latex export you sent the publisher after peer-review and before formatting (publisher proofs).</p>       <h3><span>&#10003;</span> Check there aren\'t publisher logos or formatting</h3>       <p>It\'s normal to share accepted manuscripts as the research is the same. It\'s fine to save your file as a pdf, make small edits to formatting, fix typos, remove comments, and arrange figures.</p>     </div>     <h3 class="_oaw_section _oaw_get_email"><span>&#10003;</span> Tell us your email</h3>   </div> --\x3e   <div class="_oaw_section _oaw_dark_deposit" id="_oaw_dark_deposit">     <h2>You can share your paper!</h2>     <p>We checked and unfortunately <span class="_oaw_journal">the journal</span> won\'t let you share <span class="_oaw_your_paper">your paper</span> freely with everyone. <span class="_oaw_refs"></span><br><br> The good news is the library can still legally make your paper much easier to find and access. We\'ll put the publisher PDF in <span class="_oaw_repo">ScholarWorks</span> and then share it on your behalf whenever it is requested.</p>     <h3 class="_oaw_section _oaw_get_email">All we need is your email</h3>   </div>   <div class="_oaw_section _oaw_get_email" id="_oaw_get_email">     <p><input class="_oaw_form" type="text" id="_oaw_email" placeholder="" aria-label="Enter your email" style="box-shadow:none;"></input></p>     <p class="_oaw_section _oaw_oa_deposit">We\'ll use this to send you a link. By depositing, you\'re agreeing to our <span class="_oaw_terms">terms</span>.</p>     <p class="_oaw_section _oaw_archivable">We\'ll only use this if something goes wrong.<br>     <p class="_oaw_section _oaw_dark_deposit">We\'ll only use this to send you a link to your paper when it is in <span class="_oaw_repo">ScholarWorks</span>. By depositing, you\'re agreeing to the <span class="_oaw_terms">terms</span>.</p>   </div>   <div class="_oaw_section _oaw_archivable" id="_oaw_archivable_file">     <h3>We\'ll check it\'s legal, then promote, and preserve your work</h3>     <p><input type="file" name="file" id="_oaw_file" class="_oaw_form"></p>     <p>By depositing you\'re agreeing to the <span class="_oaw_terms">terms</span> and to license your work <span class="_oaw_licence">CC-BY</span>.</p>   </div>   <div class="_oaw_section _oaw_oa_deposit _oaw_archivable _oaw_dark_deposit" id="_oaw_deposits">     <p><a href="#" class="_oaw_deposit btn-iu _oaw_button _oaw_loading" style="min-width:140px;" id="_oaw_deposit">Deposit</a></p>     <p><a href="#" class="_oaw_restart" id="_oaw_deposits_restart"><b>Do another</b></a></p>   </div> </div> <div class="_oaw_panel" id="_oaw_done" style="display:none;">   <div class="_oaw_done" id="_oaw_confirm">     <h2>We need an earlier version</h2>     <p>It looks like what you uploaded is a publisher\'s PDF which your journal prohibits legally sharing.<br><br> You\'re nearly done. We need the accepted version, not the PDF from the journal site.</p>     <p><a href="#" class="_oaw_reload btn-iu _oaw_button" id="_oaw_upload_again" style="min-width:140px;">Try uploading again</a></p>     <p><a href="#" class="_oaw_confirm _oaw_loading" id="_oaw_upload_accept"><b>My upload was an accepted manuscript</b></a></p>   </div>   <div class="_oaw_done" id="_oaw_check">     <h2>We\'ll double check your paper</h2>     <p>You\'ve done your part for now. Hopefully, we\'ll send you a link soon. First, we\'ll check to make sure it\'s legal to share.</p>   </div>   <div class="_oaw_done" id="_oaw_partial">     <h2>Congrats, you\'re done!</h2>     <p>Check back soon to see your paper live, or we\'ll email you with issues.</p>   </div>   <div class="_oaw_done" id="_oaw_zenodo">     <h2>Congrats! Your paper will be available to everyone, forever!</h2>     <div id="_oaw_zenodo_embargo"></div>     <p><input id="_oaw_zenodo_url" class="_oaw_form" type="text" style="box-shadow:none;" value=""></input></p>     <p>You can now put the link on your website, CV, any profiles, and ResearchGate.</p>   </div>   <div class="_oaw_done" id="_oaw_redeposit">     <h2>Congrats, you\'re done!</h2>     <p>Check back soon to see your paper live, or we\'ll email you with issues.</p>   </div>   <div class="_oaw_done" id="_oaw_success">     <h2>Hurray, you\'re done!</h2>     <p>We\'ll email you a link to your paper in <span class="_oaw_repo">ScholarWorks</span> soon. Next time, before you publish check to see if your journal allows you to have the most impact by making your research available to everyone, for free.</p>   </div>   <div class="_oaw_done" id="_oaw_review">     <h2>You\'ve done your part</h2>     <p>All that\'s left to do is wait. Once the journal gives you permission to share, come back and we\'ll help you finish the job.</p>   </div>   <p><a href="#" class="_oaw_restart btn-iu _oaw_button" id="_oaw_done_restart" style="min-width:140px;">Do another</a></p> </div> <div id="_oaw_error"></div> <div id="_oaw_pilot"></div>',_oaw.prototype.configure=function(t,i,e,a){var o,s,n,r,l,h,d;if("string"==typeof t&&null==i&&t.startsWith("{"))try{t=JSON.parse(t)}catch(t){}if("string"!=typeof t||null!=i||null!=this.uid&&"anonymous"!==this.uid||(this.uid=t,t=void 0),("string"==typeof t&&null!=i||null==t&&null==i)&&"{}"===JSON.stringify(this.config)){try{!1!==this.local&&"object"==typeof(h=JSON.parse(localStorage.getItem("_oaw_config_"+this.plugin)))&&null!==h&&(console.log("Config retrieved from local storage"),this.config=h)}catch(t){}if(!1!==this.remote&&this.uid&&"anonymous"!==this.uid&&"{}"===JSON.stringify(this.config)&&(_OA.jx((this.api.includes("beta.oa.works")?"https://dev.api.cottagelabs.com/service/oab":"https://api.openaccessbutton.org")+"/"+("instantill"===this.plugin?"ill":"deposit")+"/config?uid="+this.uid,void 0,(t=>(console.log("Config retrieved from API"),this.configure(t)))),!1===this.local))return}if("object"==typeof t){for(r in"string"==typeof i&&(this.uid=i),t)(null==this.config[r]||this.config[r]!==t[r]&&!0===i)&&(!1!==e&&(e=!0),this.config[r]="true"===t[r]||"false"!==t[r]&&t[r]);if(!0===i)for(s in this.config)"owner"!==s&&null==t[s]&&delete this.config[s]}else null!=t&&null!=i&&(this.config[t]="true"===i||"false"!==i&&i);for(n in!0===this.config.pilot&&(this.config.pilot=Date.now()),!0===this.config.live&&(this.config.live=Date.now()),this.config)""===this.config[n]&&delete this.config[n];for(l in d=JSON.parse(JSON.stringify(this.config)))(null==d[l]||!1===d[l]||("string"==typeof d[l]||Array.isArray(d[l]))&&0===d[l].length)&&delete d[l];try{"{}"!==JSON.stringify(d)&&!1!==this.local&&localStorage.setItem("_oaw_config_"+this.plugin,JSON.stringify(d))}catch(t){}return!1!==this.css&&this.config.css_off&&(this.css=!1,e=!0),!1!==this.bootstrap&&this.config.bootstrap_off&&(this.bootstrap=!1,e=!0),null==this.element&&(this.element="#"+this.plugin),(o=()=>{var t,i,s,n,r,h,p,_;if(!_OA.gebi(this.element))return console.log("waiting for "+this.element),setTimeout((()=>o()),100);if(!1!==e&&(console.log("Building embed"),_OA.html(this.element,""),null==this.bootstrap&&(s=document.documentElement.innerHTML,this.bootstrap=s.includes("bootstrap/")||s.includes("/bootstrap")||s.includes("bootstrap.css")||s.includes("bootstrap.min.css")||s.includes("btn-"),!0===this.bootstrap&&console.log("Found bootstrap indicators in the doc")),!0===this.bootstrap?this.template.includes("btn-primary")||(this.template=this.template.replace(/_oaw_button/g,"_oaw_button btn btn-primary").replace(/_oaw_form/g,"_oaw_form form-control")):this.template.includes("btn-primary")&&(this.template=this.template.replace(/ btn btn-primary/g,"").replace(/ form-control/g,"")),"string"==typeof this.css&&"false"!==this.css&&!0!==this.bootstrap&&(this.css.startsWith("<style>")||(this.css='<div id="_oaw_css"><style>'+this.css+"</style></div>"),_OA.append(this.element,this.css)),_OA.append(this.element,this.template),(this.data.doi||this.data.title||this.data.url||this.data.id)&&_OA.set("#_oaw_input",this.data.doi?this.data.doi:this.data.title?this.data.title:this.data.url?this.data.url:this.data.id),_OA.each("._oaw_paper",(t=>{var i;if(i=t.innerHTML,this.config.say_paper){if(!i.includes("aper"))return t.innerHTML="an article"===i?"a paper":"article"===i?"paper":"Paper"}else if(i.includes("aper"))return t.innerHTML="a paper"===i?"an article":"paper"===i?"article":"Article"})),this.config.pilot?(_="<p><br>Notice a change? We're testing a simpler and faster way to "+("instantill"===this.plugin?"get":"deposit")+" your "+(this.config.say_paper?"paper":"article")+("instantill"===this.plugin?"":"s")+". You can ",_+='<a href="mailto:'+this.cml()+'">give feedback</a> or ',"instantill"===this.plugin?_+='<a class="_oaw_ping" message="instantill_use_the_old_form" target="_blank" href="'+(this.config.advanced_ill_form?this.config.advanced_ill_form:this.config.ill_form?this.config.ill_form:"mailto:"+this.cml())+'">use the old form</a>.</p>':_+='<a class="_oaw_ping" message="shareyourpaper_use_the_old_form" target="_blank" href="'+(this.config.old_way?(this.config.old_way.includes("@")?"mailto:":"")+this.config.old_way:"mailto:"+this.cml())+'">use the old way</a>.</p>',_OA.html("#_oaw_pilot",_)):_OA.html("#_oaw_pilot",""),"shareyourpaper"===this.plugin?((null!=this.cml()||this.config.old_way&&this.config.old_way.includes("@"))&&(n=_OA.gebi("_oaw_nodoi"))&&n.setAttribute("href",n.getAttribute("href").replace("help@openaccessbutton.org",this.config.old_way&&this.config.old_way.includes("@")?this.config.old_way:this.cml())),this.config.not_library?_OA.html("._oaw_library","We have"):_OA.html("#_oaw_lib_info","Share your paper with help from the library in "+(this.config.repo_name?this.config.repo_name:"ScholarWorks")+". Legally, for free, in minutes. "),this.config.repo_name&&_OA.html("._oaw_repo",this.config.repo_name)):"instantill"===this.plugin&&(this.config.book||this.config.other?(i="<p>Need ",this.config.book&&(i+='a <a href="'+this.config.book+'">book chapter</a>'),this.config.other&&(i+=(this.config.book?" or ":" ")+'<a href="'+this.config.other+'">something else</a>'),_OA.html("#_oaw_book_or_other",i+"?</p>")):_OA.html("#_oaw_book_or_other",""),this.config.intro_off&&_OA.hide("#_oaw_intro"),this.config.advanced_ill_form||this.config.account||this.config.ill_info?(t="<p>Or ",this.config.advanced_ill_form&&(_OA.show("#_oaw_advanced_ill_form",' or <a href="'+this.config.advanced_ill_form+'">use full request form</a>'),t+='<a href="'+this.config.advanced_ill_form+'">use full request form</a>',this.config.account&&this.config.ill_info?t+=", ":(this.config.account||this.config.ill_info)&&(t+=" and ")),this.config.account&&(t+='<a href="'+this.config.account+'">view account</a>',this.config.ill_info&&(t+=" and ")),this.config.ill_info&&(t+='<a href="'+this.config.ill_info+'">learn about Interlibrary Loan</a>'),_OA.html("#_oaw_advanced_account_info",t+"</p>")):(_OA.html("#_oaw_advanced_account_info",""),_OA.hide("#_oaw_advanced_ill_form"))),_OA.listen("enter","#_oaw_input",(t=>this.find(t))),_OA.listen("enter","#_oaw_email",(t=>this.validate(t))),_OA.listen("click","._oaw_find",(t=>this.find(t))),_OA.listen("click","._oaw_submit",(t=>this.submit(t))),_OA.listen("click","._oaw_restart",(t=>this.restart(t))),_OA.listen("click","._oaw_ping",(t=>this.ping(_OA.get(t.target,"message")))),_OA.listen("click","._oaw_wrong",(t=>(t.preventDefault(),this.ping("_wrong_article"),this.metadata()))),_OA.listen("click","._oaw_reload",(t=>{var i;return t.preventDefault(),(i=_OA.gebi("_oaw_file"))&&(i.value=""),this.file=!1,this.permissions()})),_OA.listen("click","._oaw_confirm",(t=>(t.preventDefault(),this.data.confirmed=!0,this.deposit()))),_OA.listen("click","#_oaw_reviewemail",(t=>this.done("review"))),_OA.listen("click","._oaw_deposit",(t=>this.deposit(t)))),n=_OA.gebi("_oaw_config")){for(l in h=JSON.parse(JSON.stringify(d)),p={ill_institution:"institution",ill_redirect_base_url:"ill_form",ill_redirect_params:"ill_added_params",deposit_terms:"terms",problem_email:"problem",viewaccount:"account",autorun:"autorun_off",intropara:"intro_off",norequests:"requests_off",illinfo:"ill_info",noillifoa:"ill_if_oa_off",noillifsub:"ill_if_sub_off",saypaper:"say_paper",advancedform:"advanced_ill_form",deposit_date:"depositdate",deposit_terms:"terms",allow_oa_deposit:"oa_deposit_off",ROR_ID:"ror",not_a_library:"not_library",adminemail:"email",css:"css_off",bootstrap:"bootstrap_off"})null!=h[l]&&(h[p[l]]=h[l],delete h[l]);n.innerHTML=JSON.stringify(h)}return window.location.search.includes("panel=")&&this.panel(window.location.search.split("panel=")[1].split("&")[0].split("#")[0],window.location.search.includes("section=")?window.location.search.split("section=")[1].split("&")[0].split("#")[0]:void 0),a&&(("string"!=typeof a||"string"==typeof this.config.val&&this.config.val.length)&&(a=this.config.val),this.data={},this.f={},this.loading(!1),(r=_OA.gebi("_oaw_file"))&&(r.value=""),this.file=!1,_OA.hide("._oaw_panel"),_OA.show("#_oaw_inputs"),_OA.set("#_oaw_input",a),setTimeout((()=>this.find()),1)),this.needmore&&this.metadata(),"function"==typeof this.loaded?this.loaded():void 0})(),d},this.shareyourpaper=function(t){return null==t&&(t={}),t.plugin="shareyourpaper",new _oaw(t)},this.instantill=function(t){return null==t&&(t={}),t.plugin="instantill",new _oaw(t)};
